<Page xmlns="http://schemas.nativescript.org/tns.xsd" navigatingTo="navigatingTo" class="page" actionBarHidden="false"
      xmlns:sd="nativescript-pro-ui/sidedrawer"
      xmlns:drawer="components/drawer"
      xmlns:action="components/para-action-bar"
      xmlns:lv="nativescript-pro-ui/listview"

>
    <action:para-action-bar title="{{L('All expenses')}}"></action:para-action-bar>

    <sd:RadSideDrawer showOverNavigation="true" id="sideDrawer">
        <sd:RadSideDrawer.drawerContent>

            <drawer:drawer-content></drawer:drawer-content>

        </sd:RadSideDrawer.drawerContent>
        <sd:RadSideDrawer.mainContent>

            <GridLayout rows="*,*">
                <StackLayout visibility="{{connectivity_issues ? 'visible':'collapse'}}" row="0">
                    <ActivityIndicator id="con-issue-act-ind" busy="false" visibility="collapse"/>
                    <Label text="{{L('Connectivity issues with the server')}}"></Label>
                    <Button text="{{L('Try reconnecting')}}" tap="tryToReconnectToAPI"></Button>
                </StackLayout>

                <lv:RadListView visibility="{{expenses.length ?  'visible' : 'collapse'}}" row="0" id="expenses-list"
                                items="{{ expenses }}"
                                loadOnDemandMode="Auto"
                                loadMoreDataRequested="loadMoreItems"
                                itemTap="onTap"
                                pullToRefresh="true"
                                pullToRefreshInitiated="onPullToRefreshInitiated"
                >
                    <lv:RadListView.itemTemplate>
                        <DockLayout stretchLastChild="false" class='expense' height="100">

                            <StackLayout dock="left" orientation="vertical" style.verticalAlignment="center">
                                <Label text='{{name}}' class='expense-name'/>
                                <Label text="{{timestamp_utc | readableTimestamp }}"/>
                            </StackLayout>
                            <Label dock='right' class='expense-amount' text='{{$value | expenseAmountToString}}'/>
                        </DockLayout>
                    </lv:RadListView.itemTemplate>
                </lv:RadListView>

                <StackLayout visibility="{{!connectivity_issues  && expenses.length === 0 ? 'visible' : 'collapsed'}}"
                             row="1"
                             class="text-center">

                    <Label class="h3 font-awesome" text="You don't have any expenses yet" textWrap="true"/>
                    <Button class='btn font-awesome' text="&#xf067; Add an expense" tap="goToAddExpense"></Button>
                </StackLayout>
            </GridLayout>
        </sd:RadSideDrawer.mainContent>
    </sd:RadSideDrawer>
</Page>